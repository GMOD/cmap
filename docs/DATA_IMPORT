                      IMPORTING DATA INTO CMAP

To import your data into the CMAP application, you will need to do the
following:

1.  SET UP SPECIES, MAP TYPES, ETC.

Before you will be able to import any data, you will need to perform some basic
setup on the empty database.  To begin, open up the web administration
interface by pointing a web browser to the admin interface (e.g.,
"http://my.server.org/cmap/admin").  You'll need to set up what types of maps,
features, species, and evidence types you'll be working with.  For each, go to
the "View ..." choice from the main menu, then choose "Create New ..." and fill
in the correct information.  

2.  FORMAT YOUR DATA

Create a tab-delimited file with the following fields and datatypes:

    map_name: character(64) REQUIRED 
        The name of the map (AKA "linkage group," "chromosome," etc.).

    map_accession_id: character(20)
        The accession ID of the map.

    map_start: double(8,2)
        The start position of the map.

    map_stop: double(8,2)
        The stop position of the map.

    feature_accession_id: character(20)
        The accession ID of the feature.

    feature_name: character(32) REQUIRED 
        The name of the feature.

    feature_alt_name: character(32)
        The alternate name of the feature.

    feature_start: double(8,2) REQUIRED 
        The starting position of the feature on the map.

    feature_stop: double(8,2)
        The ending position of the feature on the map.

    feature_type: character(32) REQUIRED 
        The feature's type.

The first line of the file should be the tab-separated names of the
fields in whatever order you're supplying them.  Therefore, the order
of fields is not important.  You should use the above names for the
fields, but you can use spaces and capitalization for the column
names, if you like, as spaces will be converted to underscores and the
names lowercased (e.g. "Feature Alt Name" instead of
"feature_alt_name").

If the fields "map_start" and "map_stop" are not supplied, then the
start and stop positions of the map will be determined after importing
all the features by selecting the MIN and MAX start and stop positions
from the "cmap_feature" table.

3.  CREATE A NEW MAP SET

To create a map set to receive the data, you can either use the
"cmap_admin.pl" tool or the web-base admin tool.  For the first,
simply choose "Create new map set" from the "Main Menu," choose the
type of map and species and provide a name and an abbreviated name.
For the latter, choose "Create New Map Set" from the "Admin Home"
page, fill in the form and hit "Submit."  

4.  IMPORT DATA

Use the "cmap_admin.pl" script to bring in your correctly formatted
data.  Run the script, optionally passing your data file as an
argument, like so:

    $ cmap_admin.pl my_groovy_data.tsv

If you pass a file as an argument, you will be asked to confirm that
that is the file you want to use.  If you answer "no" or did not pass
a file, then you will be asked to locate the file containing your
data.  Type in the path to the file (noticing that you can use tab
completion), or type "q" to exit file selection and return to the
"Main Menu."  Once you've found your file, you'll need to tell the
tool which map set the data corresponds to.  First choose the map type
and then the species of the map set, then the map set itself.  (When
there is only one choice for any of the above, the tool will select
that one and move on.)  Lastly, you will need to confirm your choices.
If all goes well, you should see a lot of lines fly by giving you the
step-by-step progress, the message "Done," and then you will be
returned to the "Main Menu."

5.  MAKE CORRESPONDENCES

There are several ways to create correspondences among features.

A) Strictly name-base: If you choose the "Find name-based
   correspondences" command from cmap_admin.pl, a correspondence will be
   created between any two features with the *exact* same name,
   irrespective of case. You'll need to select some evidence type to
   represent this automated correspondence.

B) Import correspondences: Create a tab-delimited file that lists the
   names of two features and some evidence to support the
   correspondence. The first line of the file should contain column
   headers for "feature_name1," "feature_name2," and "evidence" (the
   order is unimportant).  Here's a sample:

	feature_name1	feature_name2	evidence
	C1008	S1633	insilico
	C11393S	E10074S	insilico
	C1238	S15180S	insilico
	bcd386	p-bcd386	name-based
	bcd386	p-bcd386	name-based
	pBF266	p-pBF266	name-based

C) Create correspondences by hand using the admin interface: Choose to
   "view" a map set in the web-based administrative tool. "View" an
   individual map, then choose to "view" a feature. From there, you will
   have the option to "Add Correspondence." Click this, and then search
   for the feature to which you wish to create a correspondence. Add
   your evidence, and you're done.

The first method is likely to be both incomplete and overly-optimistic.
For example, it will create correspondences between features called
"Centromere," which is probably not desirable.  The name comparisons
happen on both the "feature_name" and "alternate_name" from the
"cmap_feature" table.  Every feature has each of these fields compared
to those fields for every other feature, so this can take a long time
to complete.  For all of its problems, this can be a good way to get
started, and you can pare down the correspondences from there.  The
second method is the surest method as you are controlling what gets
created.  The third method is also very exact but very tedious.  I
wouldn't recommend it for creating more than a few correspondences.

After creating any new correspondences (or deleting existing ones),
be sure to run the "Reload correspondence matrix" option of the
"cmap_admin.pl" script to refresh the data that is pre-computed
and cached in the "cmap_correspondence_matrix" table.  The only option
is to completely truncate the table and reload it from scratch.

__END__
