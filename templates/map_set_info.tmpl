[% SET title='Map Set Info' %]
[% 
    INCLUDE header.tmpl 
    title=title
    no_link='map_set_info'
    help_anchor='map_set_info'
%]
<h1>[% title %]</h1>

<p>
[% IF show_restriction %]
    <div align="center">
    <form method="GET" action="map_set_info">
    <table>
        <tr>
            <td>Restrict by Species:</td>
            <td>Restrict by Map Type:</td>
        </tr>

        <tr>
            <td>
                <select name="species_aid">
                    <option value="-1">--All Species--</option>
                    [% FOREACH s=species %]
                        <option value="[% s.species_aid %]"[% IF apr.param('species_aid')==s.species_aid %] selected[% END %]>[% s.species_name %]</option>
                    [% END %]
                </select>
            </td>
            <td>
                <select name="map_type_aid">
                    <option value="-1">--All Map Types--</option>
                    [% FOREACH mt=map_types %]
                        <option value="[% mt.map_type_aid %]"[% IF apr.param('map_type_aid')==mt.map_type_aid %] selected[% END %]>[% mt.map_type %]</option>
                    [% END %]
                </select>
            </td>
        </tr>

        <tr>
            <td colspan="2" align="center">
                <input type="submit" value="Submit">
            </td>
        </tr>
    </table>
    </form>
    </div>
[% ELSE %]
    <div align="center">
        <a href="map_set_info">Show All Map Sets</a>
    </div>
[% END %]

[% IF map_sets.size %]
    <table>
        <tr>
            <td colspan="2" align="center">
                [% SET pager_url="/cmap/map_set_info?" %]
                [% PROCESS pager.tmpl %]
            </td>
        </tr>
        [% FOREACH ms=map_sets %]
            <tr bgcolor="lightgrey">
                <td align="right">Map&nbsp;Set&nbsp;Name:</td>
                <td>
                    <b>[% IF ms.can_be_reference_map %]<a href="/cmap/viewer?ref_map_set_aid=[% ms.map_set_aid %]">[% END %][% ms.map_set_name %][% IF ms.can_be_reference_map %]</a>[% END %]</b>
                </td>
            </tr> 

            <tr>
                <td align="right">Abbreviated&nbsp;Name:</td>
                <td>[% ms.short_name %]</td>
            </tr> 

            <tr>
                <td align="right">Species:</td>
                <td>
                    [% ms.full_name %] ([% ms.common_name %])
                    [% IF ms.ncbi_taxon_id %]
                        <a href="http://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=Info&id=[% ms.ncbi_taxon_id %]">(View at NCBI)</a>
                    [% END %]
                </td>
            </tr> 

            <tr>
                <td align="right">Map&nbsp;Type:</td>
                <td>[% ms.map_type %]</td>
            </tr> 

            <tr>
                <td align="right">Map&nbsp;Units:</td>
                <td>[% ms.map_units %]</td>
            </tr> 

            <tr>
                <td align="right" valign="top">Remarks:</td>
                <td>[% ms.remarks%]</td>
            </tr> 

            [% IF ms.maps.size %]
                <tr>
                    <td align="right">Maps:</td>
                    <td>
                        [% SET list=[] %]
                        [% ms.maps.push({ map_aid => -1, map_name => 'View All Maps'}) %]
                        [% FOREACH map=ms.maps %]
                          [% list.push("<a href=\"/cmap/viewer?ref_map_set_aid=$ms.map_set_aid;ref_map_aid=$map.map_aid\">$map.map_name</a>") %]
                        [% END %]
                        [% list.join(', ') %]
                    </td>
                </tr> 
            [% END %]
        [% END %]
    </table>
[% ELSE %]

    <div align="center">
    No map sets returned.
    </div>

[% END %]

<br>
<br>
<br>
<br>
<br>
[% page.end_body OR '</body>' %]
</html>
