[% 
    INCLUDE header.tmpl 
    title='Feature Detail'
    no_link='feature_detail'
    help_anchor='feature_detail'
%]
<h1>Feature Detail</h1>

<table>
    <tr>
        <td align="right">
            Map:
        </td>
        <td>
            [% feature.species_name %]-[% feature.map_set_name %]-[% feature.map_name %]
            (<a href="viewer?ref_map_set_aid=[% feature.map_set_aid %];ref_map_aid=[% feature.map_aid %];highlight=[% feature.feature_name %]">View on Map</a>)
        </td>
    </tr>

    <tr>
        <td align="right">
            Acc ID:
        </td>
        <td>
            [% feature.accession_id %]
        </td>
    </tr>

    <tr>
        <td align="right">
            Database Cross-Reference:
        </td>
        <td>
            [% IF feature.dbxref_url %]
                View at <a href="[% feature.dbxref_url %]">[% feature.dbxref.dbxref_name OR 'Reference' %]</a>
            [% ELSE %]
                No cross-reference defined.
            [% END %]
        </td>
    </tr>

    <tr>
        <td align="right">
            Feature Name:
        </td>
        <td>
            [% feature.feature_name %]
        </td>
    </tr>

    <tr>
        <td align="right">
            Alternate Name:
        </td>
        <td>
            [% feature.alternate_name %]
        </td>
    </tr>

    <tr>
        <td align="right">
            Feature Type:
        </td>
        <td>
            [% feature.feature_type %]
        </td>
    </tr>

    <tr>
        <td align="right">
            Is Landmark:
        </td>
        <td>
            [% IF feature.is_landmark; 'Yes'; ELSE; 'No'; END %]
        </td>
    </tr>

    <tr>
        <td align="right">
            Start:
        </td>
        <td>
            [% feature.start_position %]
        </td>
    </tr>

    <tr>
        <td align="right">
            Stop:
        </td>
        <td>
            [% feature.stop_position %]
        </td>
    </tr>
</table>

<table width="100%">
    <tr bgcolor="lightgrey">
        <th>Correspondences</th>
    </tr>
</table>

[% IF feature.correspondences.size %]
    <table width="100%">
        <tr>
            <th>Map Set Name</th>
            <th>Map Name</th>
            <th>Feature Name</th>
            <th>Alt. Name</th>
            <th>Evidence</th>
            <th colspan="3">Actions</th>
        </tr>
      
        [% SET i=0 %]
        [% FOREACH fc=feature.correspondences %]
            <tr bgcolor="[% IF i % 2 == 0 %]lightgrey[% ELSE %]white[% END %]">
                <td>[% fc.map_set_name %]</td>
                <td>[% fc.map_name %]</td>
                <td>[% fc.feature_name %]</td>
                <td>[% fc.alternate_name %]</td>
                <td>
                    [% FOREACH e=fc.evidence %]
                        [% e.evidence_type %]<br>
                    [% END %]
                </td>
                <td align="center">
                    <a href="feature?feature_aid=[% fc.feature_aid %]">Feature Details</a>
                </td>
                <td align="center">
                    <a href="viewer?ref_map_set_aid=[% fc.map_set_aid %];ref_map_aid=[% fc.map_aid %];highlight=[% fc.feature_name %]">View On Map</a>
                </td>
                <td align="center">
                    <a href="viewer?ref_map_set_aid=[% feature.map_set_aid %];ref_map_aid=[% feature.map_aid %];highlight=[% feature.feature_name %],[% fc.feature_name %];comparative_maps=1%3dmap_aid%3d[% fc.map_aid %]">Show Maps</a>
                </td>
            </tr>
            [% SET i=i+1 %]
        [% END %]
    </table>

[% ELSE %]

  <p>No correspondences to show.</p>

[% END %]

[% page.end_body OR '</body>' %]
